<script>
    var $toastContent = $('<span class="  color_acentuado-text">Ocurrió un error</span>');
    $(document).ready(function(){ 
        $('.tooltipped').tooltip({delay: 50});
    });
</script>

<div class="row" id="signup" ng-controller="signupctrl">
    <div class="card-panel col s12 m6 offset-m3 l4 offset-l4 z-depth-4">
        <form action="/user/create" method="post" name="signupform" novalidate>
            <div class="row margin">
                <h5 class="col s12 light-green-text center">Crear una nueva cuenta en Visual Mail</h5>
            </div>
            <div class="input-field col s7 offset-s1">
                <input id="firstname" name="firstname" type="text" 
                    ng-maxlength="15" 
                    ng-minlength="3" 
                    ng-model="firstname" 
                    ng-pattern="/^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/u" 
                    ng-required="true" />
                <label for="firstname">Nombre</label>
            </div>
            <div class="col s4 centerme red-text" role="alert" ng-messages="signupform.firstname.$error">
                <div ng-message="required"><i class="small material-icons red-green-text">error_outline</i></div>
                <div ng-message="minlength">Mínimo 3 caracteres</div> 
                <div ng-message="maxlength">Nombre muy largo</div>
                <div ng-message="pattern"> Formato no válido</div>
                <div ng-show="signupform.firstname.$valid"><i class="small material-icons light-green-text">done</i></div>
            </div>
            <div class="input-field col s7 offset-s1">
                <input id="lastname" name="lastname" type="text" 
                    ng-maxlength="30" 
                    ng-minlength="3" 
                    ng-model="lastname" 
                    ng-pattern="/^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]+$/u" 
                    ng-required="true" />
                <label for="lastname">Apellidos</label>
            </div>
            <div class="col s4 centerme red-text" role="alert" ng-messages="signupform.lastname.$error">
                <div ng-message="required"><i class="small material-icons red-green-text">error_outline</i></div>
                <div ng-message="minlength">Mínimo 3 caracteres</div>
                <div ng-message="maxlength">Apellido muy largo</div>
                <div ng-message="pattern">Formato no válido</div>
                <div ng-show="signupform.lastname.$valid"><i class="small material-icons light-green-text">done</i></div>
            </div>
            <div class="input-field col s7 offset-s1">
                <input id="imgurl" name="imgurl" placeholder="http://" type="text" ng-model="imgurl">
                <label for="imgurl" >URL imagen</label>
                <!-- pattern="https?://.+"-->
            </div>
            <div class="row col s4"></div>
            <div class="input-field col s7 offset-s1 tooltipped" data-delay="50" data-position="left" data-tooltip="hola@visualmail.com">
                <input id="email" name="email" type="email" 
                    ng-model="email" 
                    ng-pattern="/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i" 
                    ng-required="true" />
                <label for="email">Email</label>
            </div>
            <div class="col s4 centerme red-text" role="alert" ng-messages="signupform.email.$error">
                <div ng-message="required"><i class="small material-icons red-green-text">error_outline</i></div>
                <div ng-message="email">Formato no válido</div>
                <div ng-message="pattern">Formato no válido</div>
                <div ng-show="signupform.email.$valid"><i class="small material-icons light-green-text">done</i></div>
            </div>
            <div class="input-field col s7 offset-s1 tooltipped" data-delay="50" data-position="left" data-tooltip="Ingrese 3 caracteres con las iniciales de su nombre">
                <input capitalize id="initials" length="3" name="initials" type="text" 
                    ng-maxlength="3" 
                    ng-minlength="3" 
                    ng-model="initials" 
                    ng-pattern="/^[a-zA-Z]+$/" 
                    ng-required="true" />
                <label for="initials">Iniciales</label>
            </div>
            <div class="col s4 centerme red-text" role="alert" ng-messages="signupform.initials.$error">
                <div ng-message="required"><i class="small material-icons red-green-text">error_outline</i></div>
                <div ng-message="minlength">3 caracteres</div>
                <div ng-message="pattern">Formato no válido</div>
                <div ng-message="maxlength">No pueden ser más de 3 carácteres</div>
                <div ng-show="signupform.initials.$valid"><i class="small material-icons light-green-text">done</i></div>
            </div>
            <div class="input-field col s7 offset-s1 tooltipped" data-delay="50" data-position="left" data-tooltip="Selecciona un color de interacción">
                <input class="jscolor" id="color" name="color" placeholder="#FFFFFF" type="text" 
                    ng-model="color" 
                    ng-required="true" />
                <label for="color">Color de interacción</label>
            </div>
            <div class="input-field col s7 offset-s1 tooltipped" data-delay="50" data-position="left" data-tooltip="Ingrese un valor alfanúmerico, mínimo ingrese 6 carácteres">
                <input id="password" name="password" type="password" 
                    ng-maxlength="20" 
                    ng-minlength="6" 
                    ng-model="password" 
                    ng-pattern="/^[a-zA-Z0-9]*$/" 
                    ng-required="true" />
                <label for="password">Contraseña</label>
            </div>
            <div class="col s4 centerme red-text" ng-messages="signupform.password.$error" role="alert">
                <div ng-message="required"><i class="small material-icons red-text">error_outline</i></div>
                <div ng-message="pattern">Formato no válido</div>
                <div ng-message="minlength">Mínimo 6 caracteres</div>
                <div ng-message="maxlength">Contraseña muy larga</div>
                <div ng-show="signupform.password.$valid"><i class="small material-icons light-green-text">done</i></div>
            </div>
            <div class="input-field col s7 offset-s1">
                <input compare-to="password" id="confirmpassword" name="confirmpassword" type="password" 
                    ng-model="confirmpassword" 
                    ng-required="true" />
                <label for="confirmpassword" >Confirmar Contraseña</label>
            </div>
            <div class="col s4 centerme red-text" role="alert" ng-messages="signupform.confirmpassword.$error">
                <div ng-message="required"> <i class="small material-icons red-green-text">error_outline</i></div>
                <div ng-message="compareTo"> La contraseña no coincide</div>
                <div ng-show="signupform.confirmpassword.$valid"><i class="small material-icons light-green-text">done</i></div>
            </div>
            <div class="row container">
                <button class="btn-large col s12 m8 offset-m2 l8 offset-l2 light-green waves-effect waves-light" type="submit" value="Crear cuenta" ng-show="signupform.$valid">Crear cuenta</button>
                <input name="_csrf" type="hidden" value="<%= _csrf%>"/>

                <div class="col s6">
                    <% if(flash && flash.err){ %>
                    <!--<h6 class="red-text"> Ocurrió un error </h6>
                    <% Object.keys(flash.err).forEach(function(error){ %>
                    <li><%= JSON.stringify(flash.err[error])%></li>
                    <%})%>
                    -->
                    <script>Materialize.toast($toastContent, 5000);</script>
                    <% } %>
                </div>
            </div>
        </form>
    </div>
</div>